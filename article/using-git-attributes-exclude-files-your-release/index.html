<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
        <meta name="description" content="Deploying your development codebase to production seems like it has been solved many different ways, and often those ways are terrible from a security perspective.Clone the whole repository on the production webserversQuite possibly the worst idea ever, as not only is every single file on the production web servers, also every single revision of every single file is on the web server. Even worse, if the root .git directory is accessible over HTTP, the whole website can be cloned over HTTP as well.Yes you can remove the .git directory, but this will not solve all your problems.Use git archive to create a snapshot of the repositoryOne step better is to create just a snapshot of the repository using git archive. You can create a snapshot easily using git archiveZip formatgit archive master -o latest.zipCompressed tar formatgit archive master | bzip2 -9 &gt; latest.tar.bz2this will still contain files you do not want on the webserver, e.g..gitignore.gitattributespotentially other redundant files that are not needed on productionUsing git attributes combined with git archiveWe have recently switched to using git attributes on all releases to ensure only the needed files for production are sent there during a release.Sample git attributes file for Drupal 7Here is a sample git attributes file that we use for Drupal 7:# used to remove files from deployment using `git archive`# git files.gitattributes export-ignore.gitignore export-ignore# drush filesbuild.make export-ignorepatches.txt export-ignore# zen 5.x filessites/all/themes/*/sass export-ignoresites/all/themes/*/sass-extensions export-ignoresites/all/themes/*/images-source export-ignoresites/all/themes/*/fonts export-ignoresites/all/themes/*/config.rb export-ignoresites/all/themes/*/STARTERKIT export-ignore# drupal directoriesscripts export-ignoreprofiles/minimal export-ignoreprofiles/standard export-ignoreprofiles/testing export-ignore# general text files*README.txt export-ignore*readme.md export-ignore*README.md export-ignore*README export-ignore*LICENSE.txt export-ignore*license.txt export-ignore*LICENSE.html export-ignoreCOPYRIGHT.txt export-ignoreCHANGELOG.txt export-ignore*changelog.txt export-ignore*changelog.html export-ignore*CHANGES.html export-ignore*INSTALL.html export-ignore*TODO.txt export-ignore*API.txt export-ignore*api.html export-ignore*KNOWN_ISSUES.txt export-ignoreUPGRADE.txt export-ignoreweb.config export-ignoreMAINTAINERS.txt export-ignoreINSTALL*.txt export-ignore# patches*.patch export-ignore# tests*.test export-ignore# contrib (these could be security holes)sites/all/libraries/plupload/examples export-ignoresites/all/libraries/plupload/docs export-ignoresites/all/libraries/jquery.jcarousel/examples export-ignoresites/all/libraries/jquery.jcarousel/index.html export-ignoresites/all/libraries/jquery.jcarousel/style.css export-ignoresites/all/libraries/jquery.jcarousel/skins export-ignoresites/all/libraries/jquery.jcarousel/lib/jquery.jcarousel.js export-ignoresites/all/libraries/jquery.jcarousel/lib/jquery-1.4.2.min.js export-ignoresites/all/libraries/colorbox/colorbox.ai export-ignoresites/all/libraries/colorbox/*/*.html export-ignoresites/all/libraries/colorbox/content export-ignoresites/all/libraries/colorbox/jquery.colorbox.js export-ignoresites/all/modules/contrib/ckeditor/images/buttons/index.html export-ignoresites/all/modules/contrib/openlayers/tests/js/qunit/index.html export-ignoreThe sample git attributes file is rather long and exhaustive, and it covers a wide range of core and contributed modules for Drupal 7. The plupload module is especially dangerous, as the library actually comes with several PHP scripts that if your webserver allowed it to execute, it would allow anyone (anonymous included) to upload unlimited files to the webserver.You could take the export to the next level and remove several core PHP files from the release like:cron.phpinstall.phpupdate.php etcCommentsIf you have any suggestions for improvements, let me know in the comments.">
    


    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon-194x194.png" sizes="194x194">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#603cba">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- OpenGraph Tags -->
    <meta property="og:title" content="Using git attributes to exclude files from your release" />
    <meta property="og:site_name" content="Pixelite" />
    <meta property="og:url" content="http://www.pixelite.co.nz/article/using-git-attributes-exclude-files-your-release/" />
    <meta property="og:description" content="Exclude files from your exports" />
    <meta property="fb:app_id" content="410615979137383" />
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />

    
        <meta property="og:image" content="http://www.pixelite.co.nz/img/gitattributes/gitattributes.png" />
    

    <!-- Twitter cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@pixelite_">
    
        <meta name="twitter:creator" content="@wiifm">
    
    <meta name="twitter:title" content="Using git attributes to exclude files from your release">
    <meta name="twitter:description" content="Exclude files from your exports">
    
        <meta name="twitter:image" content="http://www.pixelite.co.nz/img/gitattributes/gitattributes.png">
    


    <title>Using git attributes to exclude files from your release - Pixelite</title>

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="All posts" href="http://www.pixelite.co.nz/feed.xml" />
    <link rel="alternate" type="application/rss+xml" title="All Drupal planet posts" href="http://www.pixelite.co.nz/drupalplanet.xml" />

    <link rel="canonical" href="http://www.pixelite.co.nz/article/using-git-attributes-exclude-files-your-release/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-pixelite" role="navigation">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><img alt="Pixelite homepage" src="/img/pixelite.svg" /></a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about.html">About</a>
                </li>
                <li>
                    <a href="/contact.html">Contact</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    
<!-- Main Content -->
<article itemscope="" itemtype="http://schema.org/BlogPosting">
    <meta itemprop="inLanguage" content="en-GB"/>
    <meta itemprop="wordCount" content="498"/>
    <meta itemprop="url" content="http://www.pixelite.co.nz/article/using-git-attributes-exclude-files-your-release/"/>

    <header class="intro-header" style="background-image: url('/img/gitattributes/gitattributes.png')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1 itemprop="name headline">Using git attributes to exclude files from your release</h1>
                    
                    <h2 class="subheading" itemprop="description">Exclude files from your exports</h2>
                    

                    <span class="meta">Posted by <a href="/authors/sean-hamlin/" title="View Sean Hamlin's profile"><span itemprop="author" itemscope="" itemtype="http://schema.org/Person"><span itemprop="name">Sean Hamlin</span></span></a> on <time datetime="2012-08-22T00:00:00" itemprop="datePublished">August 22, 2012</time></span>
                    <ul class="social-buttons cf">
                        <li>
                            <a href="http://twitter.com/share" class="socialite twitter-share" data-text="Using git attributes to exclude files from your release" data-url="http://www.pixelite.co.nz/article/using-git-attributes-exclude-files-your-release/" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
                        </li>
                        <li>
                            <a href="https://plus.google.com/share?url=http://www.pixelite.co.nz/article/using-git-attributes-exclude-files-your-release/" class="socialite googleplus-one" data-size="tall" data-href="http://www.pixelite.co.nz/article/using-git-attributes-exclude-files-your-release/" rel="nofollow" target="_blank"><span class="vhidden">Share on Google+</span></a>
                        </li>
                        <li>
                            <a href="http://www.facebook.com/sharer.php?u=http://www.pixelite.co.nz/article/using-git-attributes-exclude-files-your-release/&amp;t=Using%20git%20attributes%20to%20exclude%20files%20from%20your%20release" class="socialite facebook-like" data-href="http://www.pixelite.co.nz/article/using-git-attributes-exclude-files-your-release/" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
                        </li>
                        <li>
                            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http://www.pixelite.co.nz/article/using-git-attributes-exclude-files-your-release/&amp;title=Using%20git%20attributes%20to%20exclude%20files%20from%20your%20release" class="socialite linkedin-share" data-url="http://www.pixelite.co.nz/article/using-git-attributes-exclude-files-your-release/" data-counter="top" rel="nofollow" target="_blank"><span class="vhidden">Share on LinkedIn</span></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</header>

    <!-- Post Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

                <div itemprop="articleBody">
                    <p>Deploying your development codebase to production seems like it has been solved many different ways, and often those ways are terrible from a security perspective.</p><h2>Clone the whole repository on the production webservers</h2><p>Quite possibly the worst idea ever, as not only is <em>every </em>single file on the production web servers, also every single revision of every single file is on the web server. Even worse, if the root <code>.git</code> directory is accessible over HTTP, the whole website can be cloned over HTTP as well.</p><p>Yes you can remove the <code>.git</code> directory, but this will not solve all your problems.</p><h2>Use git archive to create a snapshot of the repository</h2><p>One step better is to create just a snapshot of the repository using git archive. You can create a snapshot easily using git archive</p><h3>Zip format</h3>
<pre class="brush: bash; auto-links: true; collapse: false; first-line: 1; html-script: false; smart-tabs: true; tab-size: 4; toolbar: true; codetag">git archive master -o latest.zip</pre>
<h3>Compressed tar format</h3>
<pre class="brush: bash; auto-links: true; collapse: false; first-line: 1; html-script: false; smart-tabs: true; tab-size: 4; toolbar: true; codetag">git archive master | bzip2 -9 &gt; latest.tar.bz2</pre>
<p>this will still contain files you do not want on the webserver, e.g.</p><ul><li>.gitignore</li><li>.gitattributes</li><li>potentially other redundant files that are not needed on production</li></ul><h2>Using git attributes combined with git archive</h2><p>We have recently switched to using git attributes on all releases to ensure only the needed files for production are sent there during a release.</p><h3>Sample git attributes file for Drupal 7</h3><p>Here is a sample git attributes file that we use for Drupal 7:</p>
<pre class="brush: bash; auto-links: true; collapse: false; first-line: 1; html-script: false; smart-tabs: true; tab-size: 4; toolbar: true; codetag"># used to remove files from deployment using `git archive`
# git files
.gitattributes export-ignore
.gitignore export-ignore
# drush files
build.make export-ignore
patches.txt export-ignore
# zen 5.x files
sites/all/themes/*/sass export-ignore
sites/all/themes/*/sass-extensions export-ignore
sites/all/themes/*/images-source export-ignore
sites/all/themes/*/fonts export-ignore
sites/all/themes/*/config.rb export-ignore
sites/all/themes/*/STARTERKIT export-ignore
# drupal directories
scripts export-ignore
profiles/minimal export-ignore
profiles/standard export-ignore
profiles/testing export-ignore
# general text files
*README.txt export-ignore
*readme.md export-ignore
*README.md export-ignore
*README export-ignore
*LICENSE.txt export-ignore
*license.txt export-ignore
*LICENSE.html export-ignore
COPYRIGHT.txt export-ignore
CHANGELOG.txt export-ignore
*changelog.txt export-ignore
*changelog.html export-ignore
*CHANGES.html export-ignore
*INSTALL.html export-ignore
*TODO.txt export-ignore
*API.txt export-ignore
*api.html export-ignore
*KNOWN_ISSUES.txt export-ignore
UPGRADE.txt export-ignore
web.config export-ignore
MAINTAINERS.txt export-ignore
INSTALL*.txt export-ignore
# patches
*.patch export-ignore
# tests
*.test export-ignore
# contrib (these could be security holes)
sites/all/libraries/plupload/examples export-ignore
sites/all/libraries/plupload/docs export-ignore
sites/all/libraries/jquery.jcarousel/examples export-ignore
sites/all/libraries/jquery.jcarousel/index.html export-ignore
sites/all/libraries/jquery.jcarousel/style.css export-ignore
sites/all/libraries/jquery.jcarousel/skins export-ignore
sites/all/libraries/jquery.jcarousel/lib/jquery.jcarousel.js export-ignore
sites/all/libraries/jquery.jcarousel/lib/jquery-1.4.2.min.js export-ignore
sites/all/libraries/colorbox/colorbox.ai export-ignore
sites/all/libraries/colorbox/*/*.html export-ignore
sites/all/libraries/colorbox/content export-ignore
sites/all/libraries/colorbox/jquery.colorbox.js export-ignore
sites/all/modules/contrib/ckeditor/images/buttons/index.html export-ignore
sites/all/modules/contrib/openlayers/tests/js/qunit/index.html export-ignore</pre>
<p>The sample git attributes file is rather long and exhaustive, and it covers a wide range of core and contributed modules for Drupal 7. The plupload module is especially dangerous, as the library actually comes with several PHP scripts that if your webserver allowed it to execute, it would allow anyone (anonymous included) to upload unlimited files to the webserver.</p><p>You could take the export to the next level and remove several core PHP files from the release like:</p><ul><li>cron.php</li><li>install.php</li><li>update.php etc</li></ul><h2>Comments</h2><p>If you have any suggestions for improvements, let me know in the comments.</p>

                </div>

                <hr>

                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'pixelite'; // required: replace example with your forum shortname
                    
                        var disqus_url = 'http://www.pixelite.co.nz/article/using-git-attributes-exclude-files-your-release';
                    

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/article/installing-and-configuring-postgresql-91-ubuntu-1204-local-drupal-development/" data-toggle="tooltip" data-placement="top" title="Installing and configuring PostgreSQL 9.1 on Ubuntu 12.04 for local Drupal development">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="http://www.pixelite.co.nz/article/how-use-entity-metadata-wrappers-drupal-7/" data-toggle="tooltip" data-placement="top" title="How to use Entity Metadata Wrappers with Drupal 7">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>

</article>

<hr>



    <!-- Footer -->
<footer>
    <div class="container">

        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/pixelite_">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/pixelite-co-nz">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">&copy; Pixelite 2016 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.</p>
            </div>
        </div>
    </div>
</footer>

<!-- JS libs -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script src="/js/socialite.min.js"></script>

<!-- Custom JS -->
<script src="/js/clean-blog.js"></script>

<!-- Social links -->
<script type="text/javascript">
    (function($) {
        Socialite.load();
    })(jQuery);
</script>

<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-34737960-1', 'auto');
    ga('send', 'pageview');
</script>


</body>

</html>
