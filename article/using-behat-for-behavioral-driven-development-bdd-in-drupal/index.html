<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
        <meta name="description" content="BDD allows you to write human readable stories that describe the behavior of your website.">
    


    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon-194x194.png" sizes="194x194">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#603cba">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- OpenGraph Tags -->
    <meta property="og:title" content="Using Behat for Behavioral Driven Development (BDD) in Drupal" />
    <meta property="og:site_name" content="Pixelite" />
    <meta property="og:url" content="http://www.pixelite.co.nz/article/using-behat-for-behavioral-driven-development-bdd-in-drupal" />
    <meta property="og:description" content="How to get this done in Drupal" />
    <meta property="fb:app_id" content="410615979137383" />
    <meta property="og:type" content="article" />

    <meta property="og:locale" content="en_US" />
    
        <meta property="article:author" content="Sean Hamlin" />
    
    <meta property="og:image" content="http://www.pixelite.co.nz/img/plane.jpg" />

    <!-- Twitter cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@pixelite_">
    
        <meta name="twitter:creator" content="@wiifm">
    
    <meta name="twitter:title" content="Using Behat for Behavioral Driven Development (BDD) in Drupal">
    <meta name="twitter:description" content="How to get this done in Drupal">
    <meta name="twitter:image" content="http://www.pixelite.co.nz/img/plane.jpg">

    <title>Using Behat for Behavioral Driven Development (BDD) in Drupal - Pixelite</title>

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="All posts" href="http://www.pixelite.co.nz/feed.xml" />
    <link rel="alternate" type="application/rss+xml" title="All Drupal planet posts" href="http://www.pixelite.co.nz/drupalplanet.xml" />

    <link rel="canonical" href="http://www.pixelite.co.nz/article/using-behat-for-behavioral-driven-development-bdd-in-drupal">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-pixelite" role="navigation">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><img alt="Pixelite homepage" src="/img/pixelite.svg" /></a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about.html">About</a>
                </li>
                <li>
                    <a href="/contact.html">Contact</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    

<article itemscope="" itemtype="http://schema.org/BlogPosting">
    <meta itemprop="inLanguage" content="en-GB"/>
    <meta itemprop="wordCount" content="868"/>
    <meta itemprop="url" content="http://www.pixelite.co.nz/article/using-behat-for-behavioral-driven-development-bdd-in-drupal"/>

    <!-- Post Header -->
    <header class="intro-header" style="background-image: url('/img/plane.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1 itemprop="name headline">Using Behat for Behavioral Driven Development (BDD) in Drupal</h1>
                        
                        <h2 class="subheading" itemprop="description">How to get this done in Drupal</h2>
                        

                        <span class="meta">Posted by <a href="/authors/sean-hamlin/" title="View Sean Hamlin's profile"><span itemprop="author" itemscope="" itemtype="http://schema.org/Person"><span itemprop="name">Sean Hamlin</span></span></a> on <time datetime="2015-03-14T00:00:00" itemprop="datePublished">March 14, 2015</time></span>
                        <ul class="social-buttons cf">
                            <li>
                                <a href="http://twitter.com/share" class="socialite twitter-share" data-text="Using Behat for Behavioral Driven Development (BDD) in Drupal" data-url="http://www.pixelite.co.nz/article/using-behat-for-behavioral-driven-development-bdd-in-drupal" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
                            </li>
                            <li>
                                <a href="https://plus.google.com/share?url=http://www.pixelite.co.nz/article/using-behat-for-behavioral-driven-development-bdd-in-drupal" class="socialite googleplus-one" data-size="tall" data-href="http://www.pixelite.co.nz/article/using-behat-for-behavioral-driven-development-bdd-in-drupal" rel="nofollow" target="_blank"><span class="vhidden">Share on Google+</span></a>
                            </li>
                            <li>
                                <a href="http://www.facebook.com/sharer.php?u=http://www.pixelite.co.nz/article/using-behat-for-behavioral-driven-development-bdd-in-drupal&amp;t=Using%20Behat%20for%20Behavioral%20Driven%20Development%20(BDD)%20in%20Drupal" class="socialite facebook-like" data-href="http://www.pixelite.co.nz/article/using-behat-for-behavioral-driven-development-bdd-in-drupal" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
                            </li>
                            <li>
                                <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http://www.pixelite.co.nz/article/using-behat-for-behavioral-driven-development-bdd-in-drupal&amp;title=Using%20Behat%20for%20Behavioral%20Driven%20Development%20(BDD)%20in%20Drupal" class="socialite linkedin-share" data-url="http://www.pixelite.co.nz/article/using-behat-for-behavioral-driven-development-bdd-in-drupal" data-counter="top" rel="nofollow" target="_blank"><span class="vhidden">Share on LinkedIn</span></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Post Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

                <div itemprop="articleBody">
                    <h2 id="what-is-bdd">What is BDD</h2>

<p><abbr title="Behavior Driven Development">BDD</abbr> allows you to write human readable stories that describe the behavior of your website. These stories are written from an end user’s perspective, and can then be tested against your application to see if they pass or fail. This allow you to define functionality easily and up front, and often make sense in an agile environment, or where you are making constant changes to your application and you want some sort of re-assurance it is working as intended (i.e. regression tests).</p>

<h2 id="behat-and-gherkin">Behat and Gherkin</h2>

<p>Behat is a tool that make BDD possible. The language that behat stories are written in is called Gherkin. Gherkin is a line-oriented language that uses indentation to define structure. The start of each line is usually a special keyword, these all mean something in Gherkin.</p>

<pre>
<strong>Feature:</strong> Some terse yet descriptive text of what is desired
  In order to realize a named business value
  As an explicit system actor
  I want to gain some beneficial outcome which furthers the goal

  <strong>Scenario:</strong> Some determinable business situation
    <strong>Given</strong> some precondition
      <strong>And</strong> some other precondition
     <strong>When</strong> some action by the actor
      <strong>And</strong> some other action
      <strong>And</strong> yet another action
     <strong>Then</strong> some testable outcome is achieved
      <strong>And</strong> something else we can check happens too

  <strong>Scenario:</strong> A different situation
  ...
</pre>

<p>A more concrete example, is the UNIX ls command. A stakeholder may say to you:</p>

<pre>
<strong>Feature:</strong> ls
  In order to see the directory structure
  As a UNIX user
  I need to be able to list the current directory's contents

  <strong>Scenario:</strong> List 2 files in a directory
    <strong>Given</strong> I am in a directory "test"
      <strong>And</strong> I have a file named "foo"
      <strong>And</strong> I have a file named "bar"
     <strong>When</strong> I run "ls"
     <strong>Then</strong> I should get:
       """
       bar
       foo
       """
</pre>

<p>The <a href="http://behat.readthedocs.org/en/v2.5/guides/1.gherkin.html">Gherkin documentation</a> can be found online.</p>

<h3 id="phpunit-and-behat">PHPUnit and behat</h3>

<p>Because of their very different approaches to testing, PHPUnit and Behat actually complement each other very well. A growing number of enterprise-level PHP projects are using a combination of both to achieve the best-possible test coverage.</p>

<h2 id="key-things-to-keep-in-mind-when-writing-tests">Key things to keep in mind when writing tests</h2>

<p>To help write good behat tests, here are some good guidelines to keep in mind.</p>

<h3 id="focus-on-business-value">Focus on business value</h3>

<p>When defining features (or stories) ensure that you are focusing on delivering an item of value. If you only have a few tests for your application, ensure the features that give the most business value are created first.</p>

<h3 id="focus-on-the-user">Focus on the user</h3>

<p>A critical component of Gherkin style dictates that you speak with language that the target user can reasonably be expected to understand. This user-centric focus means that everyone will be drawn back from their domains of expertise to think about what the target user of the feature needs. There’s a wide variety of users, too. Features intended for a site visitor may differ from those intended for site administrators, editors, or moderators. As the user varies, it’s possible the language used in a scenario will vary as well.</p>

<h2 id="integration-with-drupal">Integration with Drupal</h2>

<p>So you have some BDD features written, and now you want to implement them. There is a Drupal module that will help with the creation of nodes, users, vocabularies and taxonomy terms.</p>

<p>There are 3 drivers available in the <a href="https://www.drupal.org/project/drupalextension">drupal behat extension</a>, all with different pros and cons:</p>

<figure>
  <img src="http://www.pixelite.co.nz/img/behat/api.png" alt="There are 3 different Drupal drivers within the drupalextension module" class="img-responsive img-thumbnail" />
  <figcaption><small>Table of driver comparisons taken from the <a href="https://behat-drupal-extension.readthedocs.org/en/3.0/drivers.html">documentation</a>.</small></figcaption>
</figure>

<p>The most fully featured driver is the Drupal API driver, it has the limitation that it must be run on the same server that the website is run on.</p>

<h2 id="continuous-integration">Continuous integration</h2>

<p>So now you have your Behat tests set up and running on your development environment, the next step is to automate the Behat tests so that they execute automatically on a dedicated testing server after a new commit is pushed. There are a number of ways to do this:</p>

<ul>
  <li>Github and TravisCI</li>
  <li>Jenkins and use git post-receive hooks (or <a href="https://github.com/acquia/cloud-hooks">Acquia cloud hooks</a>)</li>
</ul>

<h2 id="drupal-8-and-behat">Drupal 8 and behat</h2>

<p>There is an issue open at the moment that aims to get Drupal 8 core tested with behat https://www.drupal.org/node/2232271 - this aims to introduce a new module called ‘behat’ and build in JavaScript automated testing for Drupal (at the moment this is all manual).</p>

<h2 id="resources">Resources</h2>

<p>There is a lot of information out in the Drupal community around Behat that I would encourage you to read and watch:</p>

<ul>
  <li>Konstantin (from Inviqa) at <a href="https://amsterdam2014.drupal.org/session/doing-behaviour-driven-development-behat">DrupalCon Amsterdam 2014</a></li>
  <li>Drupal.org did a Drupal 6 to Drupal 7 upgrade, and for that they invested a lot of time into creating a <a href="https://www.drupal.org/project/doobie">full test suite (called doobie)</a>, and now the test suite is used to help spot regressions in the site</li>
  <li>Large Scale Drupal (LSD) created a <a href="http://drupalwatchdog.com/system/files/Behavior-Driven%20Development%20LSD%20Guide.pdf">whitepaper on BDD with Behat and Drupal</a> which is well worth the read</li>
  <li><a href="https://www.acquia.com/blog/high-quality-php-benjamin-eberlei">High Quality PHP by Benjamin Eberlei</a></li>
  <li><a href="https://www.lullabot.com/blog/podcasts/drupalizeme-podcast/21-bdd-behat-and-drupal">Drupalize me have a podcast on BDD and Drupal</a></li>
  <li><a href="http://behat.readthedocs.org/en/v2.5/quick_intro.html">Behat documentation</a></li>
</ul>

<h2 id="comments">Comments</h2>

<p>If you have any further information that can be added, feel free to let me know in the comments.</p>

                </div>

                <hr>

                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'pixelite'; // required: replace example with your forum shortname
                    var disqus_url = 'http://www.pixelite.co.nz/article/using-behat-for-behavioral-driven-development-bdd-in-drupal';

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/article/extracting-file-folder-from-git-repository-with-full-git-history" data-toggle="tooltip" data-placement="top" title="Extracting a file or a folder from a git repository with full git history">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="http://www.pixelite.co.nz/article/how-why-you-should-update-php-to-55-with-drupal/" data-toggle="tooltip" data-placement="top" title="How and why you should update PHP to PHP 5.5 with Drupal">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>

</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">

        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/pixelite_">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/pixelite-co-nz">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">&copy; Pixelite 2015 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.</p>
            </div>
        </div>
    </div>
</footer>

<!-- JS libs -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script src="/js/socialite.min.js"></script>

<!-- Custom JS -->
<script src="/js/clean-blog.js"></script>

<!-- Social links -->
<script type="text/javascript">
    (function($) {
        Socialite.load();
    })(jQuery);
</script>

<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-34737960-1', 'auto');
    ga('send', 'pageview');
</script>


</body>

</html>
