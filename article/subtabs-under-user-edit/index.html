<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
        <meta name="description" content="To get your tabs to appear on the user edit page use hook_user_categories() and hook_menu_alter()">
    


    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon-194x194.png" sizes="194x194">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#603cba">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- OpenGraph Tags -->
    <meta property="og:title" content="How to add subtabs under the User Edit tab in Drupal" />
    <meta property="og:site_name" content="Pixelite" />
    <meta property="og:url" content="http://www.pixelite.co.nz/article/subtabs-under-user-edit" />
    <meta property="og:description" content="" />
    <meta property="fb:app_id" content="410615979137383" />
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />

    
        <meta property="og:image" content="http://www.pixelite.co.nz/img/post-bg-tabs-under-tabs.png" />
    

    <!-- Twitter cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@pixelite_">
    
        <meta name="twitter:creator" content="@unifex">
    
    <meta name="twitter:title" content="How to add subtabs under the User Edit tab in Drupal">
    <meta name="twitter:description" content="">
    
        <meta name="twitter:image" content="http://www.pixelite.co.nz/img/post-bg-tabs-under-tabs.png">
    


    <title>How to add subtabs under the User Edit tab in Drupal - Pixelite</title>

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="All posts" href="http://www.pixelite.co.nz/feed.xml" />
    <link rel="alternate" type="application/rss+xml" title="All Drupal planet posts" href="http://www.pixelite.co.nz/drupalplanet.xml" />

    <link rel="canonical" href="http://www.pixelite.co.nz/article/subtabs-under-user-edit">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-pixelite" role="navigation">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><img alt="Pixelite homepage" src="/img/pixelite.svg" /></a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about.html">About</a>
                </li>
                <li>
                    <a href="/contact.html">Contact</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    

<article itemscope="" itemtype="http://schema.org/BlogPosting">
    <meta itemprop="inLanguage" content="en-GB"/>
    <meta itemprop="wordCount" content="407"/>
    <meta itemprop="url" content="http://www.pixelite.co.nz/article/subtabs-under-user-edit"/>

    <!-- Post Header -->
    <header class="intro-header" style="background-image: url('/img/post-bg-tabs-under-tabs.png')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1 itemprop="name headline">How to add subtabs under the User Edit tab in Drupal</h1>
                        

                        <span class="meta">Posted by <a href="/authors/gold/" title="View Gold's profile"><span itemprop="author" itemscope="" itemtype="http://schema.org/Person"><span itemprop="name">Gold</span></span></a> on <time datetime="2014-12-10T00:00:00" itemprop="datePublished">December 10, 2014</time></span>
                        <ul class="social-buttons cf">
                            <li>
                                <a href="http://twitter.com/share" class="socialite twitter-share" data-text="How to add subtabs under the User Edit tab in Drupal" data-url="http://www.pixelite.co.nz/article/subtabs-under-user-edit" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
                            </li>
                            <li>
                                <a href="https://plus.google.com/share?url=http://www.pixelite.co.nz/article/subtabs-under-user-edit" class="socialite googleplus-one" data-size="tall" data-href="http://www.pixelite.co.nz/article/subtabs-under-user-edit" rel="nofollow" target="_blank"><span class="vhidden">Share on Google+</span></a>
                            </li>
                            <li>
                                <a href="http://www.facebook.com/sharer.php?u=http://www.pixelite.co.nz/article/subtabs-under-user-edit&amp;t=How%20to%20add%20subtabs%20under%20the%20User%20Edit%20tab%20in%20Drupal" class="socialite facebook-like" data-href="http://www.pixelite.co.nz/article/subtabs-under-user-edit" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
                            </li>
                            <li>
                                <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http://www.pixelite.co.nz/article/subtabs-under-user-edit&amp;title=How%20to%20add%20subtabs%20under%20the%20User%20Edit%20tab%20in%20Drupal" class="socialite linkedin-share" data-url="http://www.pixelite.co.nz/article/subtabs-under-user-edit" data-counter="top" rel="nofollow" target="_blank"><span class="vhidden">Share on LinkedIn</span></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Post Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

                <div itemprop="articleBody">
                    <h2 id="tldr">tl;dr;</h2>

<p>To get your tabs to appear on the user edit page use <a href="https://api.drupal.org/api/drupal/modules%21user%21user.api.php/function/hook_user_categories/7">hook_user_categories()</a> and <a href="https://api.drupal.org/api/drupal/modules%21system%21system.api.php/function/hook_menu_alter/7">hook_menu_alter()</a>.</p>

<h2 id="the-detail">The detail</h2>

<p>Getting submenu items to appear within the user edit area of Drupal has not always worked as I would expect from reading the documentation around <a href="https://api.drupal.org/api/drupal/modules%21system%21system.api.php/function/hook_menu/7">hook_menu()</a>. As it happens the user module provides hooks to make this quite simple.</p>

<p><a href="https://api.drupal.org/api/drupal/modules%21user%21user.api.php/function/hook_user_categories/7">hook_user_categories()</a> allows you to return a subset of the parameters you’d expect to see in <a href="https://api.drupal.org/api/drupal/modules%21system%21system.api.php/function/hook_menu/7">hook_menu()</a>.</p>

<p>In this example we would have a new set of tabs added to the User Edit page.  The first is <em>Account</em> and is now presented because we have more than one tab here now.  The second is <em>Report Settings</em> and it would have a URL like <code>user/12345/edit/report_settings</code> where <em>report_settings</em> is taken from the name parameter.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * Implements hook_user_categories().</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">my_module_user_categories</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span>
      <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;report_settings&#39;</span><span class="p">,</span>
      <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="nx">t</span><span class="p">(</span><span class="s1">&#39;Report settings&#39;</span><span class="p">),</span>
      <span class="s1">&#39;weight&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;access callback&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;user_edit_access&#39;</span><span class="p">,</span>
      <span class="s1">&#39;access arguments&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="p">)</span>
  <span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span></code></pre></div>

<p>At this point we have a new menu item presented as a tab on the user edit page and clicking it takes us to a blank form with a submit button. I think this is due to the way menu items can inherit behaviour from parent menu items. We’ll be wanting to overload that behaviour though and present our own form.  This can be done through <a href="https://api.drupal.org/api/drupal/modules%21system%21system.api.php/function/hook_menu_alter/7">hook_menu_alter()</a>.</p>

<p>Checking the keys of the array passed to <a href="https://api.drupal.org/api/drupal/modules%21system%21system.api.php/function/hook_menu_alter/7">hook_menu_alter()</a> we should find that we have a new one called <code>user/%user_category/edit/report_settings</code>. We can edit this one to point it at our preferred form built using the <a href="https://api.drupal.org/api/drupal/includes%21form.inc/group/form_api/7">Form API</a> as usual.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * Implements hook_menu_alter().</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">my_module_menu_alter</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$callbacks</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$callbacks</span><span class="p">[</span><span class="s1">&#39;user/%user_category/edit/report_settings&#39;</span><span class="p">][</span><span class="s1">&#39;page arguments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;my_module_user_report_settings&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="c1">// We need to set the file path as it defaults to the user module.</span>
  <span class="nv">$callbacks</span><span class="p">[</span><span class="s1">&#39;user/%user_category/edit/report_settings&#39;</span><span class="p">][</span><span class="s1">&#39;file path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">drupal_get_path</span><span class="p">(</span><span class="s1">&#39;module&#39;</span><span class="p">,</span> <span class="s1">&#39;my_module&#39;</span><span class="p">);</span>
  <span class="nv">$callbacks</span><span class="p">[</span><span class="s1">&#39;user/%user_category/edit/report_settings&#39;</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;my_module.user.inc&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span></code></pre></div>

<h2 id="gotchas">Gotchas</h2>

<ul>
  <li>You will want to be clearing your menu cache a lot while getting this working. Every edit will require a <code>drush cc menu</code>.</li>
  <li>Ensure you have set the <code>file path</code> in the hook_menu_alter() if you have your have your page callback or form function for drupal_get_form() in a separate file.</li>
</ul>

<h2 id="comments">Comments</h2>

<p>If you have found that this post has been helpful ping me in the comments, on twitter (<a href="http://twitter.com/unifex">@Unifex</a>) or on <a href="http://drupal.org">D.o</a> at <a href="http://drupal.org/u/Gold">Gold</a>.</p>


                </div>

                <hr>

                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'pixelite'; // required: replace example with your forum shortname
                    var disqus_url = 'http://www.pixelite.co.nz/article/subtabs-under-user-edit';

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/article/using-git-pre-commit-hooks-keep-you-drupal-codebase-clean" data-toggle="tooltip" data-placement="top" title="Using git pre-commit hooks to keep your Drupal codebase clean">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="http://www.pixelite.co.nz/article/adding-apple-android-favicons-drupal" data-toggle="tooltip" data-placement="top" title="Adding Apple and Android favicons to Drupal">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>

</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">

        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/pixelite_">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/pixelite-co-nz">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">&copy; Pixelite 2015 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.</p>
            </div>
        </div>
    </div>
</footer>

<!-- JS libs -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script src="/js/socialite.min.js"></script>

<!-- Custom JS -->
<script src="/js/clean-blog.js"></script>

<!-- Social links -->
<script type="text/javascript">
    (function($) {
        Socialite.load();
    })(jQuery);
</script>

<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-34737960-1', 'auto');
    ga('send', 'pageview');
</script>


</body>

</html>
