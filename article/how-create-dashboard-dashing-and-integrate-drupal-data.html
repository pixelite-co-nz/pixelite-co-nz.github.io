<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
        <meta name="description" content="What is Dashing">
    


    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon-194x194.png" sizes="194x194">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#603cba">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- OpenGraph Tags -->
    <meta property="og:title" content="How to create a dashboard with Dashing and integrate with Drupal data" />
    <meta property="og:site_name" content="Pixelite" />
    <meta property="og:url" content="http://www.pixelite.co.nz/article/how-create-dashboard-dashing-and-integrate-drupal-data/" />
    <meta property="og:description" content="" />
    <meta property="fb:app_id" content="410615979137383" />
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />

    
        <meta property="og:image" content="http://www.pixelite.co.nz/img/dashing/dashboard.png" />
    

    <!-- Twitter cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@pixelite_">
    
        <meta name="twitter:creator" content="@wiifm">
    
    <meta name="twitter:title" content="How to create a dashboard with Dashing and integrate with Drupal data">
    <meta name="twitter:description" content="">
    
        <meta name="twitter:image" content="http://www.pixelite.co.nz/img/dashing/dashboard.png">
    


    <title>How to create a dashboard with Dashing and integrate with Drupal data - Pixelite</title>

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="All posts" href="http://www.pixelite.co.nz/feed.xml" />
    <link rel="alternate" type="application/rss+xml" title="All Drupal planet posts" href="http://www.pixelite.co.nz/drupalplanet.xml" />

    <link rel="canonical" href="http://www.pixelite.co.nz/article/how-create-dashboard-dashing-and-integrate-drupal-data">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-pixelite" role="navigation">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><img alt="Pixelite homepage" src="/img/pixelite.svg" /></a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about.html">About</a>
                </li>
                <li>
                    <a href="/contact.html">Contact</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    
<!-- Main Content -->
<article itemscope="" itemtype="http://schema.org/BlogPosting">
    <meta itemprop="inLanguage" content="en-GB"/>
    <meta itemprop="wordCount" content="1550"/>
    <meta itemprop="url" content="http://www.pixelite.co.nz/article/how-create-dashboard-dashing-and-integrate-drupal-data"/>

    <header class="intro-header" style="background-image: url('/img/dashing/dashboard.png')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1 itemprop="name headline">How to create a dashboard with Dashing and integrate with Drupal data</h1>
                    

                    <span class="meta">Posted by <a href="/authors/sean-hamlin/" title="View Sean Hamlin's profile"><span itemprop="author" itemscope="" itemtype="http://schema.org/Person"><span itemprop="name">Sean Hamlin</span></span></a> on <time datetime="2014-07-31T00:00:00" itemprop="datePublished">July 31, 2014</time></span>
                    <ul class="social-buttons cf">
                        <li>
                            <a href="http://twitter.com/share" class="socialite twitter-share" data-text="How to create a dashboard with Dashing and integrate with Drupal data" data-url="http://www.pixelite.co.nz/article/how-create-dashboard-dashing-and-integrate-drupal-data" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
                        </li>
                        <li>
                            <a href="https://plus.google.com/share?url=http://www.pixelite.co.nz/article/how-create-dashboard-dashing-and-integrate-drupal-data" class="socialite googleplus-one" data-size="tall" data-href="http://www.pixelite.co.nz/article/how-create-dashboard-dashing-and-integrate-drupal-data" rel="nofollow" target="_blank"><span class="vhidden">Share on Google+</span></a>
                        </li>
                        <li>
                            <a href="http://www.facebook.com/sharer.php?u=http://www.pixelite.co.nz/article/how-create-dashboard-dashing-and-integrate-drupal-data&amp;t=How%20to%20create%20a%20dashboard%20with%20Dashing%20and%20integrate%20with%20Drupal%20data" class="socialite facebook-like" data-href="http://www.pixelite.co.nz/article/how-create-dashboard-dashing-and-integrate-drupal-data" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
                        </li>
                        <li>
                            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http://www.pixelite.co.nz/article/how-create-dashboard-dashing-and-integrate-drupal-data&amp;title=How%20to%20create%20a%20dashboard%20with%20Dashing%20and%20integrate%20with%20Drupal%20data" class="socialite linkedin-share" data-url="http://www.pixelite.co.nz/article/how-create-dashboard-dashing-and-integrate-drupal-data" data-counter="top" rel="nofollow" target="_blank"><span class="vhidden">Share on LinkedIn</span></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</header>

    <!-- Post Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

                <div itemprop="articleBody">
                    <h2 id="what-is-dashing">What is Dashing</h2>

<p><a href="http://dashing.io/">Dashing</a> is a Sinatra (think ruby but not rails) based framework that lets you build dashboards. It was originally made by the guys at Shopify for displaying custom dashboards on TVs around the office.</p>

<h3 id="why-use-dashing">Why use Dashing</h3>

<p>Dashing makes your life easier, freeing you up to focus on more inportant things - like what data you are looking to display, and what time of widget you want to use.</p>

<p>Features of dashing:</p>

<ul>
  <li>Opensource (MIT license)</li>
  <li>Widgets are tiny and encapsulated, made with SASS, HTML and coffeescript</li>
  <li>The dashboard itself is simply HTML and SASS, meaning you can theme and style it to suit your needs</li>
  <li>Comes bundled with several powerful widgets</li>
  <li>Widgets are powered by simply data bindings (powered by batman.js)</li>
  <li>Push and pull methods available to each widget</li>
  <li>Pull jobs can be configured to run in the background on a set interval (e.g. every 30 seconds, poll Chartbeat for new data)</li>
  <li>Layout is drag &amp; drop interface for re-arranging widgets</li>
</ul>

<h3 id="why-not-make-a-dashboard-in-drupal">Why not make a dashboard in Drupal</h3>

<p>There are <a href="https://www.drupal.org/project/homebox">several</a> <a href="https://www.drupal.org/project/dashboardify">dashboard</a> <a href="https://www.drupal.org/project/admin_dashboard">modules</a> in Drupal, and yes you can go to a <del>bit</del> lot of trouble and re-create the power of Dashing in Drupal, but there is no need.</p>

<p>Dashing is great at what it does, and it <em>only does one thing</em>.</p>

<p>Another advantage is that you can query other sources of data - e.g. Google Analytics or MailChimp and display metrics from those applications on your dashboard.</p>

<p>A really great example (including code) and can found over at <a href="http://derekweitzel.blogspot.co.nz/2014/03/a-hcc-dashboard-with-osg-accounting.html">http://derekweitzel.blogspot.co.nz/2014/03/a-hcc-dashboard-with-osg-accounting.html</a></p>

<h2 id="installation-of-dashing-on-ubuntu-1404">Installation of Dashing on Ubuntu 14.04</h2>

<p>The only real requirement is ruby 1.9+ (this comes by default in Ubunty 14.04, in Ubuntu 12.04 you need to install <strong>ruby-1.9</strong> explicitly)</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">sudo apt-get install ruby ruby-dev nodejs g++ bundler
sudo gem install dashing</code></pre></figure>

<p>you can create a new dashboard with</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">dashing new awesome_dashboard
<span class="nb">cd </span>awesome_dashboard
bundle</code></pre></figure>

<p>You start the application by</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">sudo dashing start</code></pre></figure>

<p>You now have a dashboard on http://localhost:3030 ready to go</p>

<h2 id="creating-a-new-dashing-widget">Creating a new Dashing widget</h2>

<p>There are already a few tutorials online, the best of which is probably just the <a href="https://github.com/Shopify/dashing/wiki/Additional-Widgets">existing suite of widgets available</a>.</p>

<p>Here we will go through a simple example where we want to graph the of pieces of content in the “Needs review” state (provided by Workbench moderation) in Drupal. This serves as a mini-todo list for content authors, as ideally this number should be as low as possible.</p>

<p>In this example, we are re-cycling the “List” widget.</p>

<p><strong>Place an instance of the “List” widget on a dashboard</strong> - e.g. sample.erb</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">    <span class="nt">&lt;li</span> <span class="na">data-row=</span><span class="s">&quot;1&quot;</span> <span class="na">data-col=</span><span class="s">&quot;1&quot;</span> <span class="na">data-sizex=</span><span class="s">&quot;1&quot;</span> <span class="na">data-sizey=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">data-id=</span><span class="s">&quot;newsarticlesreview&quot;</span> <span class="na">data-view=</span><span class="s">&quot;List&quot;</span> <span class="na">data-unordered=</span><span class="s">&quot;true&quot;</span> <span class="na">data-title=</span><span class="s">&quot;News articles in &#39;Needs review&#39;&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
      <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;icon-check-sign icon-background&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
    <span class="nt">&lt;/li&gt;</span></code></pre></figure>

<p><strong>Create a new job to poll for data</strong></p>

<p>Create a new file in <strong>jobs/newsarticlesreview.rb</strong>, and place:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1">#!/bin/env ruby</span>
<span class="c1"># encoding: utf-8</span>

<span class="nb">require</span> <span class="s1">&#39;net/http&#39;</span>
<span class="nb">require</span> <span class="s1">&#39;uri&#39;</span>
<span class="nb">require</span> <span class="s1">&#39;json&#39;</span>

<span class="c1"># TODO replace with a real production host</span>
<span class="n">server</span> <span class="o">=</span> <span class="s2">&quot;https://localhost&quot;</span>

<span class="no">SCHEDULER</span><span class="o">.</span><span class="n">every</span> <span class="s1">&#39;30s&#39;</span><span class="p">,</span> <span class="ss">:first_in</span> <span class="o">=&gt;</span> <span class="mi">0</span> <span class="k">do</span> <span class="o">|</span><span class="n">job</span><span class="o">|</span>

  <span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">server</span><span class="si">}</span><span class="s2">/api/content/dashboard?token=FawTP0fJgSagS1aYcM2a5Bx-MaJI8Y975NwYWP12B0E&quot;</span><span class="p">)</span>
  <span class="n">http</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">url</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>
  <span class="n">http</span><span class="o">.</span><span class="n">use_ssl</span> <span class="o">=</span> <span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">scheme</span> <span class="o">==</span> <span class="s1">&#39;https&#39;</span><span class="p">)</span>
  <span class="n">http</span><span class="o">.</span><span class="n">verify_mode</span> <span class="o">=</span> <span class="no">OpenSSL</span><span class="o">::</span><span class="no">SSL</span><span class="o">::</span><span class="no">VERIFY_NONE</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Get</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">request_uri</span><span class="p">))</span>

  <span class="c1"># Convert to JSON</span>
  <span class="n">j</span> <span class="o">=</span> <span class="no">JSON</span><span class="o">[</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="o">]</span>

  <span class="c1"># Send the joke to the text widget</span>
  <span class="n">review_content</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="n">review_content</span><span class="o">[</span><span class="s1">&#39;en&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">label</span><span class="p">:</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span> <span class="ss">value</span><span class="p">:</span> <span class="n">j</span><span class="o">[</span><span class="s1">&#39;en&#39;</span><span class="o">][</span><span class="s1">&#39;news_article&#39;</span><span class="o">][</span><span class="s1">&#39;needs_review&#39;</span><span class="o">]</span> <span class="p">}</span>
  <span class="n">review_content</span><span class="o">[</span><span class="s1">&#39;mi&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">label</span><span class="p">:</span> <span class="s1">&#39;Māori&#39;</span><span class="p">,</span> <span class="ss">value</span><span class="p">:</span> <span class="n">j</span><span class="o">[</span><span class="s1">&#39;mi&#39;</span><span class="o">][</span><span class="s1">&#39;news_article&#39;</span><span class="o">][</span><span class="s1">&#39;needs_review&#39;</span><span class="o">]</span> <span class="p">}</span>
  <span class="n">send_event</span><span class="p">(</span><span class="s2">&quot;newsarticlesreview&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="ss">items</span><span class="p">:</span> <span class="n">review_content</span><span class="o">.</span><span class="n">values</span> <span class="p">})</span>
<span class="k">end</span></code></pre></figure>

<h2 id="create-a-drupal-data-source">Create a Drupal data source</h2>

<p>Now we need to feed the Dashing request with a Drupal API. I have chosen to do all of these custom, as they are straight forward. In theory you could also craft these with the services module as well.</p>

<p><strong>Create hook_menu() entry</strong></p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="x">/**</span>
<span class="x"> * Implements hook_menu().</span>
<span class="x"> */</span>
<span class="x">function CUSTOM_menu() {</span>
<span class="x">  // Dashboard API requests. Protected using a token.</span>
<span class="x">  // e.g. api/content/dashboard?token=FawTP0fJgSagS1aYcM2a5Bx-MaJI8Y975NwYWP12B0E</span>
<span class="x">  $items[&#39;api/content/dashboard&#39;] = array(</span>
<span class="x">    &#39;title&#39; =&gt; &#39;Content types broken down by workflow status&#39;,</span>
<span class="x">    &#39;page callback&#39; =&gt; &#39;CUSTOM_content_dashboard&#39;,</span>
<span class="x">    &#39;access callback&#39; =&gt; &#39;CUSTOM_dashboard_api_access&#39;,</span>
<span class="x">    &#39;access arguments&#39; =&gt; array(&#39;api/content/dashboard&#39;),</span>
<span class="x">    &#39;type&#39; =&gt; MENU_CALLBACK,</span>
<span class="x">    &#39;file&#39; =&gt; &#39;CUSTOM.dashboard.inc&#39;,</span>
<span class="x">  );</span>
<span class="x">  return $items;</span>
<span class="x">}</span></code></pre></figure>

<p>Here we define a custom route, and declare the access callback. The access callback is special as it needs to ensure that access is restricted to only requests with a special token. The token being created from a hash of the Drupal salt combined with the current path and private key, and base64 encoded (much like <a href="https://api.drupal.org/api/drupal/includes%21common.inc/function/drupal_get_token/7">drupal_get_token()</a> without the session ID check).</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="x">/**</span>
<span class="x"> * Access callback to the dashboard API endpoints. These are protected by a</span>
<span class="x"> * token.</span>
<span class="x"> *</span>
<span class="x"> * @param String $path</span>
<span class="x"> *   The path that is being requested.</span>
<span class="x"> *</span>
<span class="x"> * @return Boolean</span>
<span class="x"> *   Whether or not the use has access to the callback.</span>
<span class="x"> */</span>
<span class="x">function CUSTOM_dashboard_api_access($path) {</span>
<span class="x">  global $is_https;</span>

<span class="x">  // HTTPS only.</span>
<span class="x">  $only_allow_https = (bool) variable_get(&#39;api_https_only&#39;, 1);</span>
<span class="x">  if ($only_allow_https &amp;&amp; !$is_https) {</span>
<span class="x">    return FALSE;</span>
<span class="x">  }</span>

<span class="x">  // Only allow get requests.</span>
<span class="x">  if ($_SERVER[&#39;REQUEST_METHOD&#39;] !== &#39;GET&#39;) {</span>
<span class="x">    return FALSE;</span>
<span class="x">  }</span>

<span class="x">  // Check token is correct.</span>
<span class="x">  $params = drupal_get_query_parameters();</span>
<span class="x">  if (!isset($params[&#39;token&#39;]) || empty($params[&#39;token&#39;])) {</span>
<span class="x">    return FALSE;</span>
<span class="x">  }</span>
<span class="x">  $valid_token = CUSTOM_token_validation($path);</span>
<span class="x">  if ($params[&#39;token&#39;] !== $valid_token) {</span>
<span class="x">    return FALSE;</span>
<span class="x">  }</span>

<span class="x">  return TRUE;</span>
<span class="x">}</span></code></pre></figure>

<p>And finally the data for the callback.</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="x">/**</span>
<span class="x"> * Gathers current content statistics from Drupal, including the amount of</span>
<span class="x"> * content broken down by a) content type, b) workflow state, c) status.</span>
<span class="x"> *</span>
<span class="x"> * @return JSON</span>
<span class="x"> */</span>
<span class="x">function CUSTOM_content_dashboard() {</span>
<span class="x">  $output = array();</span>

<span class="x">  $languages = language_list(&#39;enabled&#39;);</span>
<span class="x">  $types = node_type_get_types();</span>

<span class="x">  // Workbench states.</span>
<span class="x">  foreach ($languages[1] as $langcode =&gt; $language) {</span>
<span class="x">    foreach ($types as $machine_name =&gt; $type) {</span>
<span class="x">      // Workbench moderation in use (remove this if you do not have the module).</span>
<span class="x">      if (workbench_moderation_node_type_moderated($machine_name)) {</span>
<span class="x">        $results = db_query(&quot;SELECT COUNT(n.vid) AS total, w.state</span>
<span class="x">                             FROM {node} n</span>
<span class="x">                             JOIN {workbench_moderation_node_history} w</span>
<span class="x">                               ON w.vid = n.vid</span>
<span class="x">                             WHERE n.type = :type</span>
<span class="x">                               AND n.language = :lang</span>
<span class="x">                               AND w.current = 1</span>
<span class="x">                             GROUP BY w.state&quot;, array(&#39;:type&#39; =&gt; $machine_name, &#39;:lang&#39; =&gt; $langcode))-&gt;fetchAllAssoc(&#39;state&#39;);</span>

<span class="x">        foreach ($results as $state =&gt; $result) {</span>
<span class="x">          $output[$langcode][$machine_name][$state] = (int) $result-&gt;total;</span>
<span class="x">        }</span>
<span class="x">      }</span>

<span class="x">      // No workbench moderation for this content type, use the status column.</span>
<span class="x">      else {</span>
<span class="x">        $results = db_query(&quot;SELECT COUNT(n.nid) AS total, n.status</span>
<span class="x">                             FROM {node} n</span>
<span class="x">                             WHERE n.type = :type</span>
<span class="x">                               AND n.language = :lang</span>
<span class="x">                             GROUP BY n.status&quot;, array(&#39;:type&#39; =&gt; $machine_name, &#39;:lang&#39; =&gt; $langcode))-&gt;fetchAllAssoc(&#39;status&#39;);</span>

<span class="x">        foreach ($results as $status =&gt; $result) {</span>
<span class="x">          if ($status == NODE_PUBLISHED) {</span>
<span class="x">            $status = &#39;published&#39;;</span>
<span class="x">          }</span>
<span class="x">          else {</span>
<span class="x">            $status = &#39;unpublished&#39;;</span>
<span class="x">          }</span>
<span class="x">          $output[$langcode][$machine_name][$status] = (int) $result-&gt;total;</span>
<span class="x">        }</span>
<span class="x">      }</span>
<span class="x">    }</span>
<span class="x">  }</span>

<span class="x">  drupal_json_output($output);</span>
<span class="x">  drupal_exit();</span>
<span class="x">}</span></code></pre></figure>

<p>And there you have it. Note the above code relies on workbench moderation being present, if you do not have it, simply remove the section of the code that is relevant. Note that the API response is considerably more complex and complete than the example calls for, but this just means you can display more data in more ways on your dashboard.</p>

<p>Here is the finished product:</p>

<p><img src="/img/dashing/widget-example.png" width="379" height="343" alt="Dashing example widget" /></p>

<h2 id="extra-for-experts">Extra for experts</h2>

<p>Create a init.d script for dashing, <a href="https://gist.github.com/gregology/5313326#file-dashboard">here is a good starter</a>.</p>

<h2 id="comments">Comments</h2>

<p>Let me know if you have completed (or started) a recent project to visual data from Drupal (or related third party applications) and your experiences there. Pictures are always welcome.</p>

                </div>

                <hr>

                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'pixelite'; // required: replace example with your forum shortname
                    var disqus_url = 'http://www.pixelite.co.nz/article/how-create-dashboard-dashing-and-integrate-drupal-data';

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/article/upgrading-php-54-ubuntu-1204-lts-support-drupal-8" data-toggle="tooltip" data-placement="top" title="Upgrading PHP to 5.4 on Ubuntu 12.04 LTS to support Drupal 8">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="http://www.pixelite.co.nz/article/environment-aware-drupal-sites" data-toggle="tooltip" data-placement="top" title="Environment aware Drupal sites">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>

</article>

<hr>



    <!-- Footer -->
<footer>
    <div class="container">

        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/pixelite_">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/pixelite-co-nz">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">&copy; Pixelite 2016 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.</p>
            </div>
        </div>
    </div>
</footer>

<!-- JS libs -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script src="/js/socialite.min.js"></script>

<!-- Custom JS -->
<script src="/js/clean-blog.js"></script>

<!-- Social links -->
<script type="text/javascript">
    (function($) {
        Socialite.load();
    })(jQuery);
</script>

<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-34737960-1', 'auto');
    ga('send', 'pageview');
</script>


</body>

</html>
